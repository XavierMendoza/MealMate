<%- include("partials/header", { username }) %>

<h2>All Recipes</h2>

<a href="/recipes/add" class="btn add-btn">Add New Recipe</a>

<div class="recipe-grid">
    <% recipes.forEach(recipe => { %>
        <div class="recipe-card">

            <% if (recipe.image_url) { %>
                <img src="<%= recipe.image_url %>" style="width:100%; border-radius:6px; margin-bottom:10px;">
            <% } %>

            <h3><%= recipe.name %></h3>

            <p><strong>Category:</strong> <%= recipe.category %></p>
            <p><strong>Calories:</strong> <%= recipe.calories || "N/A" %></p>
            <p><strong>Vegetarian:</strong> <%= recipe.vegetarian ? "Yes" : "No" %></p>

            <p><strong>Ingredients:</strong><br>
                <%= recipe.ingredients && recipe.ingredients.trim() !== "" 
                    ? recipe.ingredients 
                    : "No ingredients listed." %>
            </p>

            <% if (recipe.api_id) { %>
                <button class="btn small details-btn"
                        data-id="<%= recipe.api_id %>"
                        data-local-id="<%= recipe.id %>">
                    Get Full Details
                </button>
            <% } %>

            <% if (recipe.user_id === userId) { %>
                <a href="/recipes/edit/<%= recipe.id %>" class="btn small">Edit</a>

                <form action="/recipes/delete/<%= recipe.id %>" method="POST" class="inline-form">
                    <button class="btn small delete-btn">Delete</button>
                </form>
            <% } %>
        </div>
    <% }) %>
</div>

<%- include("partials/footer") %>
